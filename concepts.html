<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>esio: Basic concepts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">esio
   &#160;<span id="projectnumber">0.1.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">The ESIO Library</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Basic concepts </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page first covers a <a class="el" href="concepts.html#conceptsusage">sample ESIO use case</a> and then provides an introduction to and details about these ESIO concepts:</p>
<ol>
<li>
<a class="el" href="concepts.html#conceptshandles">Handles</a> </li>
<li>
<a class="el" href="concepts.html#conceptsfiles">Files</a> </li>
<li>
<a class="el" href="concepts.html#conceptsattributes">Attributes</a> </li>
<li>
<a class="el" href="concepts.html#conceptslines">Lines</a> </li>
<li>
<a class="el" href="concepts.html#conceptsplanes">Planes</a> </li>
<li>
<a class="el" href="concepts.html#conceptsfields">Fields</a> </li>
<li>
<a class="el" href="concepts.html#conceptslayouts">Layouts</a> </li>
</ol>
<h1><a class="anchor" id="conceptsusage"></a>
Sample usage</h1>
<p>ESIO usage usually involves some variation on the following steps: </p>
<ol>
<li>
Initialize an opaque <a class="el" href="esio_8h.html#a14ec83780606d3fe5f3d6fbaf8143f47">esio_handle</a> for a particular MPI communicator. </li>
<li>
Create or open a data file using the handle. </li>
<li>
Write or read some attributes using the handle. </li>
<li>
Establish the parallel decomposition used for distributed line, plane, or field operations using the handle. </li>
<li>
Write or read one or more distributed lines, planes, or fields of data using the handle. </li>
<li>
Close the data file using the handle. </li>
<li>
Finalize the <code>esio_handle</code>. </li>
</ol>
<p>A complete, C-based MPI program using ESIO to write some (trivial) data might look like: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="esio_8h.html" title="Provides ESIO&#39;s C-based public API following the library&#39;s usage concepts.">esio/esio.h</a>&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;{</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    MPI_Init(&amp;argc, &amp;argv);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    atexit((<span class="keywordtype">void</span> (*) ()) MPI_Finalize);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordtype">int</span> world_size, world_rank;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    MPI_Comm_size(MPI_COMM_WORLD, &amp;world_size);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;world_rank);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="esio_8h.html#a14ec83780606d3fe5f3d6fbaf8143f47" title="An opaque type following ESIO&#39;s handle concept.">esio_handle</a> h = <a class="code" href="esio_8h.html#a3d3a940f7cf521a7f7c6ac3e5e6e1a10" title="Initialize a handle against the given MPI communicator.">esio_handle_initialize</a>(MPI_COMM_WORLD);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="esio_8h.html#a07490e5578bd054ed8b81667ba62d88e" title="Create a new file or overwrite an existing one.">esio_file_create</a>(h, <span class="stringliteral">&quot;data.h5&quot;</span>, 1 <span class="comment">/* overwrite */</span>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="esio_8h.html#ad3de4f52558e998107b71fbea7c0063c" title="Set a string-valued attribute.">esio_string_set</a>(h, <span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;program&quot;</span>, argv[0]);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordtype">int</span> version = 1;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="esio_8h.html#ab13cefed3d17a56ba332e1159fe759dd" title="Write an scalar-valued int attribute.">esio_attribute_write_int</a>(h, <span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;version&quot;</span>, &amp;version);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">double</span> example[2] = { 2.0 * world_rank, 2.0 * world_rank + 1 };</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="esio_8h.html#a8c2c5b6634e618f2fa7da9e25c4895bf" title="Establish the parallel decomposition to use for subsequent line operations.">esio_line_establish</a>(h, 2*world_size, 2*world_rank, 2);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="esio_8h.html#abaac444d8a9f0d2c187fdad9376bdd40" title="Write a scalar-valued double line.">esio_line_write_double</a>(h, <span class="stringliteral">&quot;example&quot;</span>, example, 1, NULL);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="esio_8h.html#aaf7cccb48a151ee5631f4f934d5337cf" title="Close any currently open file.">esio_file_close</a>(h);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="esio_8h.html#ae9487972a25c7c7d56e1dd164eaccee6" title="Finalize a handle.">esio_handle_finalize</a>(h);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;}</div>
</div><!-- fragment --><p> ESIO's C API is documented within the <a class="el" href="esio_8h.html" title="Provides ESIO&#39;s C-based public API following the library&#39;s usage concepts.">esio.h</a> reference material.</p>
<p>A complete, Fortran-based MPI program using ESIO to perform the same task would look like: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">program</span> main</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    <span class="keywordtype">use </span><a class="code" href="classesio.html">esio</a></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    include <span class="stringliteral">&#39;mpif.h&#39;</span>    <span class="comment">!! Prefer &#39;use mpi&#39; above &#39;implicit none&#39; if possible</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordtype">integer</span>             :: ierr, world_size, world_rank, version</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="keywordtype">type(</span><a class="code" href="esio_8h.html#a14ec83780606d3fe5f3d6fbaf8143f47">esio_handle</a><span class="keywordtype">)</span>   :: h</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordtype">character(len = 255)</span>:: str</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordtype">double precision</span>    :: example(2)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    call mpi_init(ierr)</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    call mpi_comm_size(mpi_comm_world, world_size, ierr)</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    call mpi_comm_rank(mpi_comm_world, world_rank, ierr)</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    call <a class="code" href="esio_8h.html#a3d3a940f7cf521a7f7c6ac3e5e6e1a10">esio_handle_initialize</a>(h, mpi_comm_world)</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    call <a class="code" href="esio_8h.html#a07490e5578bd054ed8b81667ba62d88e">esio_file_create</a>(h, <span class="stringliteral">&quot;data.h5&quot;</span>, .true.)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    call get_command_argument(0, str)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    call <a class="code" href="esio_8h.html#ad3de4f52558e998107b71fbea7c0063c">esio_string_set</a>(h, <span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;program&quot;</span>, trim(str))</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    version = 1</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    call <a class="code" href="interfaceesio_1_1esio__attribute__write.html#a8ef17902525a0ad0cbc1088c3a46b4bf">esio_attribute_write_integer</a>(h, <span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;version&quot;</span>, version)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    example = [2d0 * world_rank, 2d0 * world_rank + 1]</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    call <a class="code" href="esio_8h.html#a8c2c5b6634e618f2fa7da9e25c4895bf">esio_line_establish</a>(h, 2*world_size, 2*world_rank + 1, 2)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    call <a class="code" href="esio_8h.html#abaac444d8a9f0d2c187fdad9376bdd40">esio_line_write_double</a>(h, <span class="stringliteral">&quot;example&quot;</span>, example, 1)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    call <a class="code" href="esio_8h.html#aaf7cccb48a151ee5631f4f934d5337cf">esio_file_close</a>(h)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    call <a class="code" href="esio_8h.html#ae9487972a25c7c7d56e1dd164eaccee6">esio_handle_finalize</a>(h)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    call mpi_finalize(ierr)</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">end program </span>main</div>
</div><!-- fragment --><p> ESIO's Fortran API is documented, relative to the C API, within the <a class="el" href="esio_8F90.html" title="Provides ESIO&#39;s Fortran-based public API following the library&#39;s usage concepts.">esio.F90</a> reference material.</p>
<p>Note that the C sample used the zero-indexed expression <code>2*world_rank</code> within the call to esio_line_establish while the Fortran sample used the one-indexed expression <code>2*world_rank + 1</code>. ESIO's C API respects "C-isms" like row-major ordering, zero-based offsets, and calling integers <code>int</code>s. ESIO's Fortran API respects "Fortran-isms" like column-major ordering, one-based offsets, and calling integers <code>integer</code>s.</p>
<h1><a class="anchor" id="conceptshandles"></a>
Handles</h1>
<p>ESIO maintains state within opaque <a class="el" href="esio_8h.html#a14ec83780606d3fe5f3d6fbaf8143f47">esio_handles</a>. A user creates an <code>esio_handle</code> by invoking <a class="el" href="esio_8h.html#a3d3a940f7cf521a7f7c6ac3e5e6e1a10" title="Initialize a handle against the given MPI communicator.">esio_handle_initialize()</a> with an MPI communicator. All subsequent calls to the ESIO API using that particular handle <em>must be made collectively</em> across the MPI communicator supplied at the handle's creation time. When finished using a handle, a user calls <a class="el" href="esio_8h.html#ae9487972a25c7c7d56e1dd164eaccee6" title="Finalize a handle.">esio_handle_finalize()</a>.</p>
<p>Multiple <code>esio_handle</code> may be created against the same or different MPI communicators. For example, one handle may created against MPI_COMM_WORLD and another created against MPI_COMM_SELF. ESIO calls using the first handle must be made collectively across all MPI ranks. In contrast, ESIO calls using the second handle may be made on only a single rank (that is, collectively across MPI_COMM_SELF).</p>
<p>To the extent allowed by the underlying MPI stack and the parallel HDF5 implementation, ESIO is thread safe provided that a single <code>esio_handle</code> is not used concurrently by more than one thread.</p>
<h1><a class="anchor" id="conceptsfiles"></a>
Files</h1>
<p>ESIO data files are, for all intents and purposes, simply <a href="http://www.hdfgroup.org/HDF5/">HDF5</a> files usable by any application conforming to the <a href="http://www.hdfgroup.org/HDF5/">The HDF5 Group</a>'s specifications.</p>
<p>At any time, a <a class="el" href="esio_8h.html#a14ec83780606d3fe5f3d6fbaf8143f47">esio_handle</a> may have a data file associated with it. A file must be associated with a handle before any attributes or data may be read or written. Existing files may be opened using <a class="el" href="esio_8h.html#a3f3c6e87767201d900c84766bbf5f25a" title="Open an existing file.">esio_file_open()</a>. New files may be created using <a class="el" href="esio_8h.html#a07490e5578bd054ed8b81667ba62d88e" title="Create a new file or overwrite an existing one.">esio_file_create()</a>. When finished using a file, a user should call <a class="el" href="esio_8h.html#aaf7cccb48a151ee5631f4f934d5337cf" title="Close any currently open file.">esio_file_close()</a>.</p>
<p>Information written to a file is <em>always</em> buffered and should <em>not</em> be assumed to be on disk while a file is open. Buffers are flushed when a file is closed. Buffers may explicitly be flushed using <a class="el" href="esio_8h.html#a6e9b38b759cd5a1325c94796c3644a0b" title="Flush buffers associated with any currently open file.">esio_file_flush()</a>.</p>
<h1><a class="anchor" id="conceptsattributes"></a>
Attributes</h1>
<p>ESIO can read or write either numeric or string attributes. Attribute access must be done using contiguous memory and each MPI rank must write or read the same data. Attributes are often useful for tracking simulation metadata. Examples include a program version identifier, a Reynolds number, or an array containing collocation point values needed on every MPI rank. Attributes may be attached to the entire file (by specifying a location of "/") or to an existing line, plane, or field (by specifying the object's name).</p>
<p>Signed integers, single-, and double-precision floating point scalar-valued attributes are supported via methods like <a class="el" href="esio_8h.html#a64f1dfe8d050c3c9a7e60b2e5b7a5400" title="Write a scalar-valued double attribute.">esio_attribute_write_double()</a> and <a class="el" href="esio_8h.html#a1dcd92eadaec6206005e09509aeebe80" title="Read a scalar-valued double attribute.">esio_attribute_read_double()</a>. Vector-valued attributes are manipulated using methods like <a class="el" href="esio_8h.html#ab4d3fcf99b3900a8b0bd3a5dbb162465" title="Write a vector-valued double attribute.">esio_attribute_writev_double()</a> and <a class="el" href="esio_8h.html#a4a4d817441269adcda92f97e11ab6dec" title="Read a vector-valued double attribute.">esio_attribute_readv_double()</a>. When reading a numeric attribute, the user is responsible for having allocated a buffer sufficiently large to hold the information. The user may query the number of components in existing vector-valued data using <a class="el" href="esio_8h.html#a48673be26521c4a98ce3518d43c0a05d" title="Query the number of components in a numeric attribute.">esio_attribute_sizev()</a>. Notice that methods handling vector-valued numeric data uniformly contain a <em>v</em>.</p>
<p>Arbitrary length strings can be written and read using <a class="el" href="esio_8h.html#ad3de4f52558e998107b71fbea7c0063c" title="Set a string-valued attribute.">esio_string_set()</a> and <a class="el" href="esio_8h.html#a3d499938acc1289de77585fed092e1ad" title="Get a string-valued attribute.">esio_string_get()</a>. Note that, unlike numeric attribute's read methods, <a class="el" href="esio_8h.html#a3d499938acc1289de77585fed092e1ad" title="Get a string-valued attribute.">esio_string_get()</a> allocates space for variable length data. It is the user's responsibility to <code>free</code> the storage allocated by <a class="el" href="esio_8h.html#a3d499938acc1289de77585fed092e1ad" title="Get a string-valued attribute.">esio_string_get()</a>.</p>
<h1><a class="anchor" id="conceptslines"></a>
Lines</h1>
<p>ESIO can read or write distributed one-dimensional, numeric data (termed "lines"). Though reading or writing a numeric field must be done collectively, different ranks can (and often do) manipulate disjoint data within a line.</p>
<p>The parallel decomposition for line operations is established by having all ranks collectively invoke <a class="el" href="esio_8h.html#a8c2c5b6634e618f2fa7da9e25c4895bf" title="Establish the parallel decomposition to use for subsequent line operations.">esio_line_establish()</a>. Each MPI rank must supply </p>
<ol>
<li>
the global number of data elements within the line (<code>aglobal</code>),  </li>
<li>
the global starting offset to be handled by this rank (<code>astart</code>), and </li>
<li>
the number of data elements to be handled by this rank (<code>alocal</code>). </li>
</ol>
<p>The global number of data elements specified must be identical across all ranks. Global offsets start at zero within the C API. The behavior of a write operation is undefined when <code>astart</code> and <code>alocal</code> do not specify disjoint data. Once established, this parallel decomposition is in effect for all line operations until <a class="el" href="esio_8h.html#a8c2c5b6634e618f2fa7da9e25c4895bf" title="Establish the parallel decomposition to use for subsequent line operations.">esio_line_establish()</a> is called again.</p>
<p>In addition to a type and a memory buffer, when reading or writing a line each MPI rank must supply the stride between adjacent data elements <em>in the local memory buffer</em> (<code>astride</code>). Strides, which must be nonnegative, are specified in terms of the scalar size. For example, when writing <code>double</code> precision data strides are expressed in units of <code>sizeof(double)</code>. Specifying a zero <code>astride</code> is equivalent to specifying that the data is stored contiguously in memory. Data is <em>always</em> stored contiguously in the file.</p>
<p>Example methods for scalar-valued lines are <a class="el" href="esio_8h.html#a441603bf6035abea6e07c519fb8cbf9f" title="Write a scalar-valued float line.">esio_line_write_float()</a> and <a class="el" href="esio_8h.html#aebbe221f06632a3da1e9305e62c83983" title="Read a scalar-valued float line.">esio_line_read_float()</a>. Information about the size of a line within a data file may be obtained using <a class="el" href="esio_8h.html#a9e85b2442cc8c5622902249a8c87de8e" title="Query the global number of scalars within a line.">esio_line_size()</a>.</p>
<p>Vector-valued lines may also be utilized. These may be useful for storing complex numbers (as a two-component vector) or other "interleaved" data. Vector components must be adjacent in memory. Example methods for vector-valued lines are <a class="el" href="esio_8h.html#aba0f6f0eea40ad7b361ab8522afbbac4" title="Write a vector-valued float line.">esio_line_writev_float()</a> and <a class="el" href="esio_8h.html#a5e03f5f2b1db1f6f4661fa50011e7c67" title="Read a vector-valued float line.">esio_line_readv_float()</a>. Information about the size of a line within a data file, including the number of vector components it contains, may be obtained using <a class="el" href="esio_8h.html#ae61ad36a6e8b3bdaa4261a24e026e853" title="Query the global number of vectors and components within a line.">esio_line_sizev()</a>.</p>
<p>Strides between vector-valued line data are expressed in terms of the size of a single component. For example, strides for a five-component vector in double precision are expressed in terms of <code>sizeof(double)</code>. This allows the same <code>astride</code> value provided to ESIO to be used in other pointer arithmetic contexts. Unfortunately, due to a limitation in HDF5, <code>astride</code> must be an even multiple of the number of components in use.</p>
<h1><a class="anchor" id="conceptsplanes"></a>
Planes</h1>
<p>ESIO can read or write distributed two-dimensional, numeric data (termed "planes"). Such operations can be thought of as a tensor product of two <a class="el" href="concepts.html#conceptslines">line</a> operations in all senses. In addition to a line's <code>aglobal</code>, <code>astart</code>, etc., a plane contains <code>bglobal</code>, <code>bstart</code>, etc. The parallel decomposition used for planes is controlled via <a class="el" href="esio_8h.html#ab1c1cdbbd91817ffb8d6ddfcc0e421b2" title="Establish the parallel decomposition to use for subsequent plane operations.">esio_plane_establish()</a>. The "A" direction is the faster index in files and appears after the "B" direction in all C API calls. Typically the "A" direction should be the faster direction in memory as well.</p>
<p>Sample plane routines are <a class="el" href="esio_8h.html#a620b0732fb58417ac73378c96b8bc944" title="Write a scalar-valued float plane.">esio_plane_write_float()</a>, <a class="el" href="esio_8h.html#ae09cc7659aebc7f4de2c66544bf1d265" title="Write a vector-valued float plane.">esio_plane_writev_float()</a>, <a class="el" href="esio_8h.html#a98f588c9a18d5eb4aaa1dc8855858852" title="Read a scalar-valued float plane.">esio_plane_read_float()</a>, and <a class="el" href="esio_8h.html#aa27f6fc6983883be2fb586e061630e87" title="Read a vector-valued float plane.">esio_plane_readv_float()</a>. Existing plane data may be queried using <a class="el" href="esio_8h.html#a9f4a24bebff4161c03d33a2d6a2052d0" title="Query the global number of scalars within a plane.">esio_plane_size()</a> or <a class="el" href="esio_8h.html#a34f784907c59b6a09a02c9fe0f8f314d" title="Query the global number of vectors and components within a plane.">esio_plane_sizev()</a>.</p>
<h1><a class="anchor" id="conceptsfields"></a>
Fields</h1>
<p>ESIO can read or write distributed three-dimensional, numeric data (termed "fields"). Field methods add <code>cglobal</code>, <code>cstart</code>, etc. arguments beyond those found for a <a class="el" href="concepts.html#conceptsplanes">plane</a>. The parallel decomposition used for fields is controlled via <a class="el" href="esio_8h.html#ad83d128e8cb7a62f7de0f040302bc516" title="Establish the parallel decomposition to use for subsequent field operations.">esio_field_establish()</a>. The "A" direction is the fastest index in files and appears rightmost in all C API calls. Typically the "A" direction should be the fastest direction in memory as well.</p>
<p>Sample field routines are <a class="el" href="esio_8h.html#a1f1d0e6e06fee40dc1a2daccf2de229d" title="Write a scalar-valued int field.">esio_field_write_int()</a>, <a class="el" href="esio_8h.html#a8b4c8fe2cda77a8d47625d8a9b560303" title="Read a scalar-valued int field.">esio_field_read_int()</a>, <a class="el" href="esio_8h.html#a226937b3c1bb110c790032a7310d2e37" title="Write a vector-valued int field.">esio_field_writev_int()</a>, and <a class="el" href="esio_8h.html#ae4589f9325b8560bd92d8eca80cbd8a4" title="Read a vector-valued int field.">esio_field_readv_int()</a>. Existing field data may be queried using <a class="el" href="esio_8h.html#a20128d78c9df1d0619fe8e59ee716944" title="Query the global number of scalars within a field.">esio_field_size()</a> or <a class="el" href="esio_8h.html#a4f7272310158e75ca0c6e28d1f869616" title="Query the global number of vectors and components within a field.">esio_field_sizev()</a>.</p>
<h1><a class="anchor" id="conceptslayouts"></a>
Layouts</h1>
<p>To provide flexibility and aid IO performance tuning for particular HPC platforms, <a class="el" href="concepts.html#conceptsfields">fields</a> may be laid out in HDF5 files in different manners (termed "layouts"). Fields are stored with sufficient metadata for ESIO to be able to determine which layout was used to write data to file. Further, operations on any existing field will always use the layout with which a field was initially created.</p>
<p>The total number of field layouts available may be queried using <a class="el" href="esio_8h.html#a61f544363c058483793d13758f41249d" title="Query the number of layouts available within ESIO.">esio_field_layout_count()</a>. The default layout associated with a particular <a class="el" href="esio_8h.html#a14ec83780606d3fe5f3d6fbaf8143f47">esio_handle</a> can be retrieved using <a class="el" href="esio_8h.html#a7e948dbfe1bae6de360d8a852ca20e5d" title="Get the default layout associated with the given handle.">esio_field_layout_get()</a> and specified using <a class="el" href="esio_8h.html#a4bfd0e1e587262cd636a22ed498781d5" title="Set the default layout associated with the given handle.">esio_field_layout_set()</a>. The default layout is used whenever esio writes a new field to file. Note that any existing layout is preserved when a field is overwritten.</p>
<p>Two layouts are available in the current ESIO release. The first (and default) layout 0 provides maximum interoperability with other HDF5-based applications. The second, layout 1, has provided better parallel IO throughput on some systems. Layout 1 is readable by other HDF5-based applications but may require additional logic to extract the full three dimensional data in, for example, visualization applications. Future layout numbers will be monotonically increasing and stable across ESIO versions.</p>
<p>Users are advised to choose a non-default layout only after having benchmarked the available layouts and determined that performance gains offset usability and data longevity. At such a time, applications can be retrofit to use a higher performance layout simply by adding an <a class="el" href="esio_8h.html#a4bfd0e1e587262cd636a22ed498781d5" title="Set the default layout associated with the given handle.">esio_field_layout_set()</a> call immediately after <a class="el" href="esio_8h.html#a3d3a940f7cf521a7f7c6ac3e5e6e1a10" title="Initialize a handle against the given MPI communicator.">esio_handle_initialize()</a>. All legacy fields will continue to work alongside any new fields. </p>
</div></div><!-- contents -->
<hr size="1"/><address style="text-align: right;"><small>
Generated on Thu Jan 16 2014 10:16:33 for esio
by&nbsp;<a href="http://www.doxygen.org/index.html">
<em>doxygen</em></a>
1.8.2</small></address>
</body>
</html>
