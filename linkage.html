<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>esio: Linking applications</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">esio
   &#160;<span id="projectnumber">0.1.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">The ESIO Library</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Linking applications </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Compiling and linking a C/C++ application against ESIO</h2>
<p>To compile and link a C or C++ application against your ESIO installation, the installation's <code>include</code> directory and <code>lib</code> directory must be added to your C/C++ compiler's include and library search paths, respectively. You will need to supply flags to link against ESIO <em>and</em> HDF5's basic and high-level libraries. Note that you will either need to use your MPI implementation's C/C++ compiler wrapper script, denoted here by <code>$(MPICC)</code>, or you will additionally need to provide MPI-related flags within the sample commands below.</p>
<p>This tutorial assumes you installed HDF5 under $HDF5HOME and also that at ESIO configuration time you specified <code>&ndash;prefix=$HOME</code> to install ESIO under your home directory (It may be necessary to include your home directory under in </p>
<div class="fragment"><div class="line">LD_LIBRARY_PATH </div>
</div><!-- fragment --><p>). In this case, compiling and linking an MPI application consisting of a single source file named <code>app.c</code> might look as follows:</p>
<div class="fragment"><div class="line">&gt; $(MPICC) -I$HOME/include app.c -L$HOME/lib -lesio -L$HDF5HOME -lhdf5_hl -lhdf5 -lz -lm </div>
</div><!-- fragment --><p>This is error prone as you must supply the same HDF5 installation directories used at ESIO configuration time. Continuing the example, if you set your <code>PKG_CONFIG_PATH</code> environment variable to contain <code>$HOME/lib/pkgconfig</code> you can use <a href="http://pkg-config.freedesktop.org/wiki/"><code>pkg-config</code></a> to lookup the relevant linking information automatically:</p>
<div class="fragment"><div class="line">&gt; $(MPICC) `pkg-config --cflags <a class="code" href="classesio.html">esio</a>-hdf5` app.c `pkg-config --libs <a class="code" href="classesio.html">esio</a>-hdf5` </div>
</div><!-- fragment --><p>Finally, if you are using HDF5's parallel compiler wrapper script <code>h5pcc</code> the above two examples no longer need to include many HDF5-related specifics:</p>
<div class="fragment"><div class="line">&gt; h5pcc -I$HOME/include app.c -L$HOME/lib -lesio </div>
</div><!-- fragment --><div class="fragment"><div class="line">&gt; h5pcc `pkg-config --cflags <a class="code" href="classesio.html">esio</a>` app.c `pkg-config --libs <a class="code" href="classesio.html">esio</a>` </div>
</div><!-- fragment --><p>Using pkg-config will avoid many easy-to-make mistakes. It is highly recommended you use pkg-config with ESIO where possible.</p>
<h2>Compiling and linking a Fortran application against ESIO</h2>
<p>To compile and link a Fortran 90 application against your ESIO installation, the installation's <code>lib</code> directory must be added to both your Fortran compiler's include and library search paths. In particular, if you do not provide <code>lib</code> within the search path you will see error messages stating that <code>esio.mod</code> is missing. You will need to supply flags to link against ESIO's Fortran library (<code>esiof</code>) <em>and</em> HDF5's basic and high-level C libraries (<code>hdf5</code> and <code>hdf5_hl</code>). The HDF5 Fortran libraries (<code>hdf5_fortran</code> and <code>hdf5hl_fortran</code>) are <code>not</code> required. You do not need to have built HDF5 with Fortran support enabled.</p>
<p>Note that you will either need to use your MPI implementation's Fortran compiler wrapper script, denoted here by <code>$(MPIFC)</code>, or you will additionally need to provide MPI-related flags within the sample commands below.</p>
<p>Assuming the same installation detailed in the C/C++ examples just above, you would compile and link a Fortran MPI application consisting of a single source file named <code>app.F90</code> as follows:</p>
<div class="fragment"><div class="line">&gt; $(MPIFC) -I$HOME/lib app.F90 -L$HOME/lib -lesiof -L$HDF5HOME -lhdf5_hl -lhdf5 -lz -lm </div>
</div><!-- fragment --><p>Using pkg-config simplifies the process considerably:</p>
<div class="fragment"><div class="line">&gt; $(MPIFC) `pkg-config --variable=fflags <a class="code" href="classesio.html">esio</a>-hdf5` app.F90 `pkg-config --variable=flibs <a class="code" href="classesio.html">esio</a>-hdf5` </div>
</div><!-- fragment --><p>Again, if you are using HDF5's parallel compiler wrapper script <code>h5pfc</code> the above two examples become simpler:</p>
<div class="fragment"><div class="line">&gt; h5pfc -I$HOME/lib app.F90 -L$HOME/lib -lesiof </div>
</div><!-- fragment --><div class="fragment"><div class="line">&gt; h5pfc `pkg-config --variable=fflags <a class="code" href="classesio.html">esio</a>` app.F90 `pkg-config --variable=flibs <a class="code" href="classesio.html">esio</a>` </div>
</div><!-- fragment --><p><b>Important Note:</b> F90 module file formats are not consistent across multiple compilers. Therefore, a Fortran application and the ESIO F90 interface <em>must</em> be built with the same Fortran compiler family to ensure compatibility.</p>
<h2>Obtaining ESIO configuration information from pkg-config</h2>
<p>ESIO's pkg-config files capture many configuration-time settings so that they can be retrieved easily. For example, the MPI and HDF5 compiler wrapper scripts used to build an ESIO installation can be retrieved as follows:</p>
<div class="fragment"><div class="line">&gt; pkg-config --variable=mpicc        <a class="code" href="classesio.html">esio</a>-hdf5</div>
<div class="line">&gt; pkg-config --variable=hdf5_version <a class="code" href="classesio.html">esio</a>-hdf5</div>
<div class="line">&gt; pkg-config --variable=h5pcc        <a class="code" href="classesio.html">esio</a>-hdf5</div>
</div><!-- fragment --><p>These values could be used, for example, in a standalone Makefile. Provided that your PKG_CONFIG_PATH is configured correctly, such a Makefile can automatically determine the information necessary to build an ESIO-based application.</p>
<h2>Using ESIO with GNU Autoconf/Automake</h2>
<p>Because an ESIO installation provides pkg-config information, using ESIO with <a href="http://www.gnu.org/software/autoconf/">Autoconf</a> and <a href="http://www.gnu.org/software/automake/">Automake</a> in a C/C++ project is straightforward. The exact details are beyond the scope of this documentation, but the process consists of the following steps:</p>
<ol>
<li>
Use <a href="http://www.gnu.org/software/autoconf-archive/ax_mpi.html"><code>AX_MPI</code></a> within your <code>configure.ac</code> to determine where your system's MPI compiler wrappers are located. </li>
<li>
Ensure that automake is using the MPI compiler wrapper by including a statement like <code>CC=@MPICC@</code> within your Makefile.am. </li>
<li>
Use the PKG_CHECK_MODULES autoconf macro to look for ESIO's <code>esio-hdf5</code> pkg-config information at configure time. Load the information into variables like <code>ESIO_CFLAGS</code> and <code>ESIO_LIBS</code>. </li>
<li>
Add <code>ESIO_CFLAGS</code> and <code>ESIO_LIBS</code> to the appropriate targets within your Makefile.am. </li>
</ol>
<p>One very good, but not ESIO-specific, write up on using GNU Autoconf/Automake with pkg-config is <a href="http://www.openismus.com/documents/linux/using_libraries/using_libraries">Using C/C++ libraries with Automake and Autoconf</a>. </p>
</div></div><!-- contents -->
<hr size="1"/><address style="text-align: right;"><small>
Generated on Thu Jan 16 2014 10:16:33 for esio
by&nbsp;<a href="http://www.doxygen.org/index.html">
<em>doxygen</em></a>
1.8.2</small></address>
</body>
</html>
